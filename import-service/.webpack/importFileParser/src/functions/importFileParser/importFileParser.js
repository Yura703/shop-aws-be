(()=>{"use strict";var e={874:function(e,t,r){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.main=t.importFileParser=void 0;const s=r(444),i=o(r(336)),a=o(r(280)),d=[];let n="";t.importFileParser=async e=>{const t=new i.default.S3({region:"eu-west-1"});if(!e.Records)return{statusCode:404};for(let r of e.Records){const e=r.s3.object.key;n=r.s3.bucket.name;const o={Bucket:n,Key:e};await new Promise(((r,s)=>{t.getObject(o).createReadStream().pipe((0,a.default)(["title","description","price","count","imageId"])).on("data",(e=>{d.push(e)})).on("end",(async()=>{console.log(JSON.stringify(d)),await t.copyObject({Bucket:n,Key:e.replace("uploaded","parsed"),CopySource:n+"/"+e}).promise(),await t.deleteObject({Bucket:n,Key:e}).promise(),r("OK")}))}))}return{statusCode:200,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":!0,"Access-Control-Allow-Methods":"GET, PUT, POST, DELETE","Access-Control-Expose-Headers":"*",Allow:"GET, PUT, POST, DELETE"},body:JSON.stringify(d)}},t.main=(0,s.middyfy)(t.importFileParser)},444:function(e,t,r){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.middyfy=void 0;const s=o(r(862)),i=o(r(582));t.middyfy=e=>(0,s.default)(e).use((0,i.default)())},862:e=>{e.exports=require("@middy/core")},582:e=>{e.exports=require("@middy/http-json-body-parser")},336:e=>{e.exports=require("aws-sdk")},280:e=>{e.exports=require("csv-parser")}},t={},r=function r(o){var s=t[o];if(void 0!==s)return s.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,r),i.exports}(874),o=exports;for(var s in r)o[s]=r[s];r.__esModule&&Object.defineProperty(o,"__esModule",{value:!0})})();